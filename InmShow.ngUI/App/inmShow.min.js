"use strict";var app=angular.module("inmShowApp",["ngRoute","LocalStorageModule","angular-loading-bar"]);app.config(function(n){n.when("/home",{controller:"homeController",templateUrl:"/views/home.html"});n.when("/login",{controller:"loginController",templateUrl:"/views/login.html"});n.when("/signup",{controller:"signupController",templateUrl:"/views/signup.html"});n.when("/orders",{controller:"ordersController",templateUrl:"/views/orders.html"});n.otherwise({redirectTo:"/home"})});app.run(["authService",function(n){n.fillAuthData()}]);app.config(function(n){n.interceptors.push("authInterceptorService")});app.factory("authInterceptorService",["$q","$location","localStorageService",function(n,t,i){var r={},u=function(n){n.headers=n.headers||{};var t=i.get("authorizationData");return t&&(n.headers.Authorization="Bearer "+t.token),n},f=function(i){return i.status===401&&t.path("/login"),n.reject(i)};return r.request=u,r.responseError=f,r}]);app.factory("authService",["$http","$q","localStorageService",function(n,t,i){var e="http://localhost:51517/",u={},r={isAuth:!1,userName:""},o=function(t){return f(),n.post(e+"api/account/register",t).then(function(n){return n})},s=function(u){var s="grant_type=password&username="+u.userName+"&password="+u.password,o=t.defer();return n.post(e+"token",s,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(n){i.set("authorizationData",{token:n.access_token,userName:u.userName});r.isAuth=!0;r.userName=u.userName;o.resolve(n)}).error(function(n){f();o.reject(n)}),o.promise},f=function(){i.remove("authorizationData");r.isAuth=!1;r.userName=""},h=function(){var n=i.get("authorizationData");n&&(r.isAuth=!0,r.userName=n.userName)};return u.saveRegistration=o,u.login=s,u.logOut=f,u.fillAuthData=h,u.authentication=r,u}]);app.factory("ordersService",["$http",function(n){var i="http://localhost:51517/",t={},r=function(){return n.get(i+"api/InmAbstracts/GetAll").then(function(n){return n})};return t.getOrders=r,t}]);app.controller("indexController",["$scope","$location","authService",function(n,t,i){n.logOut=function(){i.logOut();t.path("/home")};n.authentication=i.authentication}]),function(){function n(){function t(){}var n=this;n.title="homeController";t()}angular.module("inmShowApp").controller("homeController",["$location","$scope",n])}();app.controller("loginController",["$scope","$location","authService",function(n,t,i){n.loginData={userName:"",password:""};n.message="";n.login=function(){i.login(n.loginData).then(function(){t.path("/home")},function(t){n.message=t.error_description})}}]);app.controller("signupController",["$scope","$location","$timeout","authService",function(n,t,i,r){n.savedSuccessfully=!1;n.message="";n.registration={userName:"",password:"",confirmPassword:""};n.signUp=function(){r.saveRegistration(n.registration).then(function(){n.savedSuccessfully=!0;n.message="User has been registered successfully, you will be redicted to login page in 2 seconds.";u()},function(t){var u=[],r,i;for(r in t.data.modelState)for(i=0;i<t.data.modelState[r].length;i++)u.push(t.data.modelState[r][i]);n.message="Failed to register user due to:"+u.join(" ")})};var u=function(){var n=i(function(){i.cancel(n);t.path("/login")},2e3)}}]),function(){function n(){function t(){}var n=this;n.title="clientCtrl";t()}angular.module("inmShowApp").controller("clientCtrl",["$location",n])}();
//# sourceMappingURL=inmShow.min.js.map